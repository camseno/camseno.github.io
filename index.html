<!doctype html>
<html lang="id" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kuisioner MGMP Bahasa Inggris</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <script type="module" src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js"></script>
  <script type="module" src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
  <style>
    body {
      box-sizing: border-box;
      font-family: 'Plus Jakarta Sans', sans-serif;
    }
    
    .gradient-bg {
      background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 50%, #3d7ab5 100%);
    }
    
    .card-shadow {
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
    }
    
    .input-focus:focus {
      outline: none;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
    }
    
    .radio-custom:checked + label {
      background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
      color: white;
      border-color: transparent;
    }
    
    .radio-custom:checked + label .radio-dot {
      background: white;
    }
    
    .btn-submit {
      background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
      transition: all 0.3s ease;
    }
    
    .btn-submit:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(245, 158, 11, 0.4);
    }
    
    .btn-submit:disabled {
      opacity: 0.7;
      cursor: not-allowed;
    }
    
    .fade-in {
      animation: fadeIn 0.5s ease-out;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .toast {
      animation: slideIn 0.3s ease-out;
    }
    
    @keyframes slideIn {
      from { opacity: 0; transform: translateX(100%); }
      to { opacity: 1; transform: translateX(0); }
    }
    
    .spinner {
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-top-color: white;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      animation: spin 0.8s linear infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full">
  <div id="app-wrapper" class="min-h-full gradient-bg overflow-auto"><!-- Toast Container -->
   <div id="toast-container" class="fixed top-4 right-4 z-50 flex flex-col gap-2"></div>
   <div class="min-h-full flex items-center justify-center p-4 py-8">
    <div class="w-full max-w-2xl"><!-- Header -->
     <div class="text-center mb-6 fade-in">
      <div class="inline-flex items-center justify-center w-20 h-20 bg-white rounded-full mb-4 shadow-lg">
       <svg class="w-10 h-10 text-blue-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
       </svg>
      </div>
      <h1 id="org-name" class="text-2xl md:text-3xl font-bold text-white mb-2">MGMP Bahasa Inggris SMP</h1>
      <p class="text-blue-200 text-lg">Kabupaten Purbalingga</p>
     </div><!-- Form Card -->
     <div id="form-container" class="bg-white rounded-2xl card-shadow p-6 md:p-8 fade-in">
      <h2 id="form-title" class="text-xl md:text-2xl font-bold text-gray-800 mb-2 text-center">Kuisioner Kegiatan MGMP</h2>
      <p id="question-text" class="text-gray-600 text-center mb-6">Kegiatan apa yang paling Bapak/Ibu butuhkan pada kegiatan MGMP mendatang?</p>
      <form id="questionnaire-form" class="space-y-6"><!-- Nama -->
       <div><label for="nama" class="block text-sm font-semibold text-gray-700 mb-2"> Nama Lengkap <span class="text-red-500">*</span> </label> <input type="text" id="nama" name="nama" required class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl input-focus transition-all duration-200 hover:border-blue-300" placeholder="Masukkan nama lengkap Anda">
       </div><!-- Sekolah -->
       <div><label for="sekolah" class="block text-sm font-semibold text-gray-700 mb-2"> Asal Sekolah <span class="text-red-500">*</span> </label> <input type="text" id="sekolah" name="sekolah" required class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl input-focus transition-all duration-200 hover:border-blue-300" placeholder="Contoh: SMP Merdeka Purbalingga">
       </div><!-- Pilihan Kegiatan -->
       <div><label class="block text-sm font-semibold text-gray-700 mb-3"> Pilihan Kegiatan <span class="text-red-500">*</span> </label>
        <div class="space-y-3" id="options-container">
         <div class="relative"><input type="radio" id="option1" name="pilihan" value="Workshop Penyusunan Modul Ajar dengan Integrasi Deep Learning" class="radio-custom sr-only" required> <label for="option1" class="flex items-start gap-3 p-4 border-2 border-gray-200 rounded-xl cursor-pointer transition-all duration-200 hover:border-blue-400 hover:bg-blue-50"> <span class="radio-dot w-5 h-5 min-w-5 mt-0.5 rounded-full border-2 border-gray-300 transition-all duration-200"></span> <span class="text-gray-700">Workshop Penyusunan Modul Ajar dengan Integrasi Deep Learning</span> </label>
         </div>
         <div class="relative"><input type="radio" id="option2" name="pilihan" value="Pelatihan Pengembangan Media Ajar Interaktif Berbasis On Line dengan Bantuan AI dan Github sebagai " class="radio-custom sr-only"> <label for="option2" class="flex items-start gap-3 p-4 border-2 border-gray-200 rounded-xl cursor-pointer transition-all duration-200 hover:border-blue-400 hover:bg-blue-50"> <span class="radio-dot w-5 h-5 min-w-5 mt-0.5 rounded-full border-2 border-gray-300 transition-all duration-200"></span> <span class="text-gray-700">Pelatihan Pengembangan Media Ajar Interaktif Digital Berbasis Kurikulum Merdeka</span> </label>
         </div>
         <div class="relative"><input type="radio" id="option3" name="pilihan" value="Pembuatan Aplikasi Asesmen Berbasis Komputer dengan Menggunakan Canva AI dan Github" class="radio-custom sr-only"> <label for="option3" class="flex items-start gap-3 p-4 border-2 border-gray-200 rounded-xl cursor-pointer transition-all duration-200 hover:border-blue-400 hover:bg-blue-50"> <span class="radio-dot w-5 h-5 min-w-5 mt-0.5 rounded-full border-2 border-gray-300 transition-all duration-200"></span> <span class="text-gray-700">Pembuatan Aplikasi Asesmen Berbasis Komputer dengan Menggunakan Canva AI</span> </label>
         </div>
         <div class="relative"><input type="radio" id="option4" name="pilihan" value="Pelatihan Penyusunan Asesmen Diagnostik, Formatif, dan Sumatif" class="radio-custom sr-only"> <label for="option4" class="flex items-start gap-3 p-4 border-2 border-gray-200 rounded-xl cursor-pointer transition-all duration-200 hover:border-blue-400 hover:bg-blue-50"> <span class="radio-dot w-5 h-5 min-w-5 mt-0.5 rounded-full border-2 border-gray-300 transition-all duration-200"></span> <span class="text-gray-700">Pelatihan Penyusunan Asesmen Diagnostik, Formatif, dan Sumatif</span> </label>
         </div>
         <div class="relative"><input type="radio" id="option5" name="pilihan" value="Penguatan Asesmen HOTS dan Literasi Numerasi" class="radio-custom sr-only"> <label for="option5" class="flex items-start gap-3 p-4 border-2 border-gray-200 rounded-xl cursor-pointer transition-all duration-200 hover:border-blue-400 hover:bg-blue-50"> <span class="radio-dot w-5 h-5 min-w-5 mt-0.5 rounded-full border-2 border-gray-300 transition-all duration-200"></span> <span class="text-gray-700">Penguatan Asesmen HOTS dan Literasi Numerasi</span> </label>
         </div>
         <div class="relative"><input type="radio" id="option6" name="pilihan" value="Best Practice Pengembangan Game Edukatif untuk Pembelajaran Bahasa Inggris" class="radio-custom sr-only"> <label for="option6" class="flex items-start gap-3 p-4 border-2 border-gray-200 rounded-xl cursor-pointer transition-all duration-200 hover:border-blue-400 hover:bg-blue-50"> <span class="radio-dot w-5 h-5 min-w-5 mt-0.5 rounded-full border-2 border-gray-300 transition-all duration-200"></span> <span class="text-gray-700">Best Practice Pengembangan Game Edukatif untuk Pembelajaran Bahasa Inggris</span> </label>
         </div>
         <div class="relative"><input type="radio" id="option7" name="pilihan" value="Lainnya" class="radio-custom sr-only"> <label for="option7" class="flex items-start gap-3 p-4 border-2 border-gray-200 rounded-xl cursor-pointer transition-all duration-200 hover:border-blue-400 hover:bg-blue-50"> <span class="radio-dot w-5 h-5 min-w-5 mt-0.5 rounded-full border-2 border-gray-300 transition-all duration-200"></span> <span class="text-gray-700">Lainnya (sebutkan di bawah)</span> </label>
         </div>
        </div>
       </div><!-- Lainnya Input -->
       <div id="lainnya-container" class="hidden"><label for="lainnya" class="block text-sm font-semibold text-gray-700 mb-2"> Jelaskan pilihan lainnya <span class="text-red-500">*</span> </label> <textarea id="lainnya" name="lainnya" rows="3" class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl input-focus transition-all duration-200 hover:border-blue-300 resize-none" placeholder="Tuliskan kegiatan yang Anda butuhkan..."></textarea>
       </div><!-- Submit Button --> <button type="submit" id="submit-btn" class="w-full btn-submit text-white font-bold py-4 px-6 rounded-xl text-lg flex items-center justify-center gap-2"> <span id="btn-text">Kirim Jawaban</span>
        <div id="btn-spinner" class="spinner hidden"></div></button>
      </form>
     </div><!-- Success Message -->
     <div id="success-container" class="hidden bg-white rounded-2xl card-shadow p-8 text-center fade-in">
      <div class="inline-flex items-center justify-center w-20 h-20 bg-green-100 rounded-full mb-4">
       <svg class="w-10 h-10 text-green-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
       </svg>
      </div>
      <h2 class="text-2xl font-bold text-gray-800 mb-2">Terima Kasih!</h2>
      <p class="text-gray-600 mb-6">Jawaban Anda telah berhasil disimpan. Partisipasi Bapak/Ibu sangat berarti bagi pengembangan MGMP.</p><button id="submit-another-btn" class="inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white font-semibold rounded-xl hover:bg-blue-700 transition-colors">
       <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
       </svg> Isi Kuisioner Lagi </button>
     </div><!-- Response Counter -->
     <div id="response-counter" class="mt-4 text-center">
      <p class="text-blue-200 text-sm"><span id="response-count">0</span> respons telah diterima</p>
     </div><!-- Footer -->
     <div class="text-center mt-6 text-blue-200 text-sm">
      <p>Â© 2024 MGMP Bahasa Inggris SMP Kabupaten Purbalingga</p>
     </div>
    </div>
   </div>
  </div>
  <script type="module">
    // Firebase Configuration
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
    import { getDatabase, ref, push, onValue, get } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';

    const firebaseConfig = {
      apiKey: "AIzaSyCIOSFOL-Z4-wdu6soKXYXAAyWwHp43lLY",
      authDomain: "mgmp-6f2c9.firebaseapp.com",
      databaseURL: "https://mgmp-6f2c9-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "mgmp-6f2c9",
      storageBucket: "mgmp-6f2c9.firebasestorage.app",
      messagingSenderId: "17985473220",
      appId: "1:17985473220:web:61b844d90daaed1313d791",
      measurementId: "G-4785CD27EJ"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const database = getDatabase(app);
    const respondenRef = ref(database, 'responden');

    // Default configuration
    const defaultConfig = {
      form_title: 'Kuisioner Kegiatan MGMP',
      organization_name: 'MGMP Bahasa Inggris SMP',
      question_text: 'Kegiatan apa yang paling Bapak/Ibu butuhkan pada kegiatan MGMP mendatang?',
      background_color: '#1e3a5f',
      surface_color: '#ffffff',
      text_color: '#1f2937',
      primary_action_color: '#f59e0b',
      secondary_action_color: '#3b82f6'
    };

    let config = { ...defaultConfig };
    let responses = [];
    let isSubmitting = false;

    // DOM Elements
    const form = document.getElementById('questionnaire-form');
    const formContainer = document.getElementById('form-container');
    const successContainer = document.getElementById('success-container');
    const lainnyaContainer = document.getElementById('lainnya-container');
    const lainnyaInput = document.getElementById('lainnya');
    const submitBtn = document.getElementById('submit-btn');
    const btnText = document.getElementById('btn-text');
    const btnSpinner = document.getElementById('btn-spinner');
    const responseCount = document.getElementById('response-count');
    const submitAnotherBtn = document.getElementById('submit-another-btn');
    const option7 = document.getElementById('option7');

    // Show toast notification
    function showToast(message, type = 'success') {
      const container = document.getElementById('toast-container');
      const toast = document.createElement('div');
      toast.className = `toast px-4 py-3 rounded-lg shadow-lg flex items-center gap-2 ${
        type === 'success' ? 'bg-green-600 text-white' : 'bg-red-600 text-white'
      }`;
      
      const icon = type === 'success' 
        ? '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>'
        : '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>';
      
      toast.innerHTML = `${icon}<span>${message}</span>`;
      container.appendChild(toast);
      
      setTimeout(() => {
        toast.style.opacity = '0';
        toast.style.transform = 'translateX(100%)';
        setTimeout(() => toast.remove(), 300);
      }, 3000);
    }

    // Toggle lainnya input visibility
    document.querySelectorAll('input[name="pilihan"]').forEach(radio => {
      radio.addEventListener('change', (e) => {
        if (e.target.value === 'Lainnya') {
          lainnyaContainer.classList.remove('hidden');
          lainnyaInput.required = true;
        } else {
          lainnyaContainer.classList.add('hidden');
          lainnyaInput.required = false;
          lainnyaInput.value = '';
        }
      });
    });

    // Set loading state
    function setLoading(loading) {
      isSubmitting = loading;
      submitBtn.disabled = loading;
      btnText.textContent = loading ? 'Mengirim...' : 'Kirim Jawaban';
      btnSpinner.classList.toggle('hidden', !loading);
    }

    // Show success screen
    function showSuccess() {
      formContainer.classList.add('hidden');
      successContainer.classList.remove('hidden');
    }

    // Show form
    function showForm() {
      form.reset();
      lainnyaContainer.classList.add('hidden');
      lainnyaInput.required = false;
      successContainer.classList.add('hidden');
      formContainer.classList.remove('hidden');
    }

    // Load response count from Firebase
    function loadResponseCount() {
      onValue(respondenRef, (snapshot) => {
        const data = snapshot.val();
        const count = data ? Object.keys(data).length : 0;
        responseCount.textContent = count;
      });
    }

    // Handle form submission
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      if (isSubmitting) return;
      
      const formData = new FormData(form);
      const nama = formData.get('nama')?.trim();
      const sekolah = formData.get('sekolah')?.trim();
      const pilihan = formData.get('pilihan');
      const lainnya = formData.get('lainnya')?.trim() || '';
      
      // Validation
      if (!nama || !sekolah || !pilihan) {
        showToast('Mohon lengkapi semua field yang wajib diisi.', 'error');
        return;
      }
      
      if (pilihan === 'Lainnya' && !lainnya) {
        showToast('Mohon jelaskan pilihan lainnya.', 'error');
        return;
      }
      
      setLoading(true);
      
      try {
        // Prepare data for Firebase
        const responseData = {
          nama: nama,
          sekolah: sekolah,
          pilihan: pilihan === 'Lainnya' ? '' : pilihan,
          pilihan_lain: pilihan === 'Lainnya' ? lainnya : ''
        };
        
        // Push to Firebase
        await push(respondenRef, responseData);
        
        showSuccess();
        showToast('Terima kasih! Jawaban Anda telah tersimpan.', 'success');
      } catch (error) {
        console.error('Firebase error:', error);
        showToast('Gagal menyimpan data. Silakan coba lagi.', 'error');
      } finally {
        setLoading(false);
      }
    });

    // Submit another response
    submitAnotherBtn.addEventListener('click', showForm);

    // Apply config to UI
    async function onConfigChange(cfg) {
      config = { ...defaultConfig, ...cfg };
      
      // Update text content
      document.getElementById('form-title').textContent = config.form_title || defaultConfig.form_title;
      document.getElementById('org-name').textContent = config.organization_name || defaultConfig.organization_name;
      document.getElementById('question-text').textContent = config.question_text || defaultConfig.question_text;
      
      // Update colors
      const appWrapper = document.getElementById('app-wrapper');
      appWrapper.style.background = `linear-gradient(135deg, ${config.background_color || defaultConfig.background_color} 0%, ${adjustColor(config.background_color || defaultConfig.background_color, 30)} 100%)`;
      
      // Update surface color
      formContainer.style.backgroundColor = config.surface_color || defaultConfig.surface_color;
      successContainer.style.backgroundColor = config.surface_color || defaultConfig.surface_color;
      
      // Update text colors
      document.getElementById('form-title').style.color = config.text_color || defaultConfig.text_color;
      document.getElementById('question-text').style.color = adjustColor(config.text_color || defaultConfig.text_color, 40);
      
      // Update button colors
      submitBtn.style.background = `linear-gradient(135deg, ${config.primary_action_color || defaultConfig.primary_action_color} 0%, ${adjustColor(config.primary_action_color || defaultConfig.primary_action_color, -20)} 100%)`;
      submitAnotherBtn.style.backgroundColor = config.secondary_action_color || defaultConfig.secondary_action_color;
    }

    // Adjust color brightness
    function adjustColor(hex, percent) {
      const num = parseInt(hex.replace('#', ''), 16);
      const amt = Math.round(2.55 * percent);
      const R = Math.min(255, Math.max(0, (num >> 16) + amt));
      const G = Math.min(255, Math.max(0, (num >> 8 & 0x00FF) + amt));
      const B = Math.min(255, Math.max(0, (num & 0x0000FF) + amt));
      return '#' + (0x1000000 + R * 0x10000 + G * 0x100 + B).toString(16).slice(1);
    }

    // Map config to capabilities
    function mapToCapabilities(cfg) {
      return {
        recolorables: [
          {
            get: () => cfg.background_color || defaultConfig.background_color,
            set: (value) => { cfg.background_color = value; window.elementSdk.setConfig({ background_color: value }); }
          },
          {
            get: () => cfg.surface_color || defaultConfig.surface_color,
            set: (value) => { cfg.surface_color = value; window.elementSdk.setConfig({ surface_color: value }); }
          },
          {
            get: () => cfg.text_color || defaultConfig.text_color,
            set: (value) => { cfg.text_color = value; window.elementSdk.setConfig({ text_color: value }); }
          },
          {
            get: () => cfg.primary_action_color || defaultConfig.primary_action_color,
            set: (value) => { cfg.primary_action_color = value; window.elementSdk.setConfig({ primary_action_color: value }); }
          },
          {
            get: () => cfg.secondary_action_color || defaultConfig.secondary_action_color,
            set: (value) => { cfg.secondary_action_color = value; window.elementSdk.setConfig({ secondary_action_color: value }); }
          }
        ],
        borderables: [],
        fontEditable: {
          get: () => cfg.font_family || defaultConfig.font_family || 'Plus Jakarta Sans',
          set: (value) => { cfg.font_family = value; window.elementSdk.setConfig({ font_family: value }); }
        },
        fontSizeable: undefined
      };
    }

    // Map config to edit panel values
    function mapToEditPanelValues(cfg) {
      return new Map([
        ['form_title', cfg.form_title || defaultConfig.form_title],
        ['organization_name', cfg.organization_name || defaultConfig.organization_name],
        ['question_text', cfg.question_text || defaultConfig.question_text]
      ]);
    }

    // Initialize application
    async function init() {
      // Initialize Element SDK
      if (window.elementSdk) {
        window.elementSdk.init({
          defaultConfig,
          onConfigChange,
          mapToCapabilities,
          mapToEditPanelValues
        });
      }
      
      // Apply initial config
      await onConfigChange(config);
      
      // Load response count
      loadResponseCount();
    }

    init();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9bf2f55970ba1982',t:'MTc2ODYyMjU2MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>


